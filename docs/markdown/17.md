# Go 测试（模糊、基准、单元测试）

[toc]

## 单元测试

**Go语言中自带轻量级的测试框架testing和自带的go test命令来实现单元测试和性能测试**

> 单元测试能及时发现程序设计或者实现的逻辑错误，而性能测试能使程序在高并发的状态下还能保持稳定。



## 测试用例的编写规则

::: tip 测试规则：

1. 测试用例文件必须以 `_test` 结尾，例如：`util_test.go`
2. 功能测试用例方法必须 `Test` 开头
3. 模糊测试用例方法必须 `Fuzz` 开头
4. 基准测试用例方法必须 `Benchmark` 开头
5. 文件夹`_test` 结尾的测试包，会被编译成分离包
6. `go help test` 、 `go help testflag` 查看帮助

:::



## go test 模式

**1. 本地模式： `go test`或者 `go test -v`**

**2. 列表模式：编译并运行命令行上列出的每一个包，`go test util`、`go test ./` 等**



## 测试用例

💡简单的一个案例如下：

```go
package util

/* 测试用例，必须以util_test命名 */

import (
	"fmt"
	"testing"
)

var commTestData []commStruct

// 定义全局变量，用于测试
type commStruct struct {
	// 代码块
	Group    string
	SizeStr  string //输入
	Expected int64  //期望值
	Expected string //期望值
}

// 功能测试：主要验证功能是否正常
func TestParseSize(t *testing.T) {
	testData := commTestData
	for _, v := range testData {
		if v.Group == "ParseSize" {
			actual := ParseSize(v.SizeStr)
			if actual != v.Expected {
				t.Errorf("ParseSize(%s) = %d, expected %d", v.SizeStr, actual, v.Expected)
			}
		}
	}
}

// 模糊测试
func TestFuzzy(t *testing.T) {
	fmt.Println("util_test.go")
}

// 精确测试
func TestExact(t *testing.T) {
	fmt.Println("util_test.go")
}

// 性能测试
func Benchmark(b *testing.B) {
	fmt.Println("util_test.go")
}

// 基准测试
func Benchmark(b *testing.B) {
	fmt.Println("util_test.go")
}

// TestMain函数，用于测试前的初始化
func TestMain(m *testing.M) {
	initCommonData()
}

func initCommonData() {
	commTestData = []commStruct{ //测试数据
		{"ParseSize", "1", 1, "1"},
		{"ParseSize", "1k", 1024, "1k"},
		{"ParseSize", "1m", 1024 * 1024, "1m"},
		{"ParseSize", "1g", 1024 * 1024 * 1024, "1g"},
		{"ParseSize", "1t", 1024 * 1024 * 1024 * 1024, "1t"},
		{"ParseSize", "1p", 1024 * 1024 * 1024 * 1024 * 1024, "1p"},
		{"ParseSize", "1e", 1024 * 1024 * 1024 * 1024 * 1024 * 1024, "1e"},
		{"ParseSize", "1z", 1024 * 1024 * 1024 * 1024 * 1024 * 1024 * 1024, "1z"},
	}
	m.Run()
}
```





## END 链接

<ul><li><div><a href = '16.md' style='float:left'>⬆️上一节🔗</a><a href = '18.md' style='float: right'>⬇️下一节🔗</a></div></li></ul>

+ [Ⓜ️回到目录🏠](../README.md)

+ [**🫵参与贡献💞❤️‍🔥💖**](https://nsddd.top/archives/contributors))

+ ✴️版权声明 &copy; :本书所有内容遵循[CC-BY-SA 3.0协议（署名-相同方式共享）&copy;](http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0协议文本) 































